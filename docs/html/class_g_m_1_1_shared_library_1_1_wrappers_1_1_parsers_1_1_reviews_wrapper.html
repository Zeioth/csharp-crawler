<!-- HTML header for doxygen 1.8.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <!-- For Mobile Devices -->
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
        <meta name="generator" content="Doxygen 1.8.9.1"/>
        <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
        <title>Google Play Tools: GM.SharedLibrary.Wrappers.Parsers.ReviewsWrapper Class Reference</title>
        <!--<link href="tabs.css" rel="stylesheet" type="text/css"/>-->
        <script type="text/javascript" src="dynsections.js"></script>
        <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
        <link href="doxygen.css" rel="stylesheet" type="text/css" />
        <link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
        <script type="text/javascript" src="doxy-boot.js"></script>
    </head>
    <body>
        <nav class="navbar navbar-default" role="navigation">
            <div class="container">
                <div class="navbar-header">
                    <a class="navbar-brand">Google Play Tools </a>
                </div>
            </div>
        </nav>
        <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
            <div class="content" id="content">
                <div class="container">
                    <div class="row">
                        <div class="col-sm-12 panel panel-default" style="padding-bottom: 15px;">
                            <div style="margin-bottom: 15px;">
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Home</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="wiki.htm"><span>Wiki</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespace_g_m.html">GM</a></li><li class="navelem"><a class="el" href="namespace_g_m_1_1_shared_library.html">SharedLibrary</a></li><li class="navelem"><a class="el" href="namespace_g_m_1_1_shared_library_1_1_wrappers.html">Wrappers</a></li><li class="navelem"><a class="el" href="namespace_g_m_1_1_shared_library_1_1_wrappers_1_1_parsers.html">Parsers</a></li><li class="navelem"><a class="el" href="class_g_m_1_1_shared_library_1_1_wrappers_1_1_parsers_1_1_reviews_wrapper.html">ReviewsWrapper</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#properties">Properties</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="class_g_m_1_1_shared_library_1_1_wrappers_1_1_parsers_1_1_reviews_wrapper-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">GM.SharedLibrary.Wrappers.Parsers.ReviewsWrapper Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Wrapper of the Parser class. It parses comments from an app.  
 <a href="class_g_m_1_1_shared_library_1_1_wrappers_1_1_parsers_1_1_reviews_wrapper.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a1aca02d9dbc1e41b3a33ea491c719fb8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_g_m_1_1_shared_library_1_1_models_1_1_app_reviews_result.html">AppReviewsResult</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_g_m_1_1_shared_library_1_1_wrappers_1_1_parsers_1_1_reviews_wrapper.html#a1aca02d9dbc1e41b3a33ea491c719fb8">GetAppReviews</a> (<a class="el" href="class_g_m_1_1_shared_library_1_1_wrappers_1_1_web_utils_1_1_web_request_wrapper.html">WebRequestWrapper</a> server, <a class="el" href="class_g_m_1_1_shared_library_1_1_parsers_1_1_parser.html">Parser</a> parser, <a class="el" href="class_g_m_1_1_shared_library_1_1_wrappers_1_1_mongo_d_b_1_1_mongo_d_b_wrapper.html">MongoDBWrapper</a> mongoDB, <a class="el" href="class_g_m_1_1_shared_library_1_1_models_1_1_app_model.html">AppModel</a> parsedApp, bool parseReviewsEnabled=false, bool parseUsersEnabled=false, int maxUsersPerApp=0, int nUsers=-1, bool allowAnyDate=false)</td></tr>
<tr class="memdesc:a1aca02d9dbc1e41b3a33ea491c719fb8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the app reviews as a List&lt;AppReview&gt;. CAUTION: If you are parsing more than one language, the program will use more RAM.  <a href="#a1aca02d9dbc1e41b3a33ea491c719fb8">More...</a><br /></td></tr>
<tr class="separator:a1aca02d9dbc1e41b3a33ea491c719fb8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="properties"></a>
Properties</h2></td></tr>
<tr class="memitem:af50cec793c3919393d0a917f6f3ebb00"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_g_m_1_1_shared_library_1_1_wrappers_1_1_parsers_1_1_reviews_wrapper.html#af50cec793c3919393d0a917f6f3ebb00">ParsedUsers</a><code> [get, set]</code></td></tr>
<tr class="separator:af50cec793c3919393d0a917f6f3ebb00"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a1dbf6ef30abf44904c7e9a72d5045294"><td class="memItemLeft" align="right" valign="top">string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_g_m_1_1_shared_library_1_1_wrappers_1_1_parsers_1_1_reviews_wrapper.html#a1dbf6ef30abf44904c7e9a72d5045294">GetAppReviewsResponse</a> (string appID, int reviewsPage, string language, <a class="el" href="class_g_m_1_1_shared_library_1_1_wrappers_1_1_web_utils_1_1_web_request_wrapper.html">WebRequestWrapper</a> server)</td></tr>
<tr class="memdesc:a1dbf6ef30abf44904c7e9a72d5045294"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the app reviews as a normalized string.  <a href="#a1dbf6ef30abf44904c7e9a72d5045294">More...</a><br /></td></tr>
<tr class="separator:a1dbf6ef30abf44904c7e9a72d5045294"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74654ff93385f598128c2d42742b32b2"><td class="memItemLeft" align="right" valign="top">string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_g_m_1_1_shared_library_1_1_wrappers_1_1_parsers_1_1_reviews_wrapper.html#a74654ff93385f598128c2d42742b32b2">NormalizeResponse</a> (string jsonResponse)</td></tr>
<tr class="memdesc:a74654ff93385f598128c2d42742b32b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Normalizes the response Replacing invalid characters with valid ones to ensure HTML correct formation.  <a href="#a74654ff93385f598128c2d42742b32b2">More...</a><br /></td></tr>
<tr class="separator:a74654ff93385f598128c2d42742b32b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:ad57377c39e0155917bd8346f5f0d23d8"><td class="memItemLeft" align="right" valign="top">readonly Logger&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_g_m_1_1_shared_library_1_1_wrappers_1_1_parsers_1_1_reviews_wrapper.html#ad57377c39e0155917bd8346f5f0d23d8">logger</a> = LogManager.GetCurrentClassLogger ()</td></tr>
<tr class="separator:ad57377c39e0155917bd8346f5f0d23d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5ffd98d568cafb0d8b18aafcd8d647b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_g_m_1_1_shared_library_1_1_wrappers_1_1_parsers_1_1_reviews_wrapper.html#ab5ffd98d568cafb0d8b18aafcd8d647b">parsedUsers</a> = 0</td></tr>
<tr class="separator:ab5ffd98d568cafb0d8b18aafcd8d647b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Wrapper of the Parser class. It parses comments from an app. </p>

<p>Definition at line <a class="el" href="_reviews_wrapper_8cs_source.html#l00015">15</a> of file <a class="el" href="_reviews_wrapper_8cs_source.html">ReviewsWrapper.cs</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a1aca02d9dbc1e41b3a33ea491c719fb8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_g_m_1_1_shared_library_1_1_models_1_1_app_reviews_result.html">AppReviewsResult</a> GM.SharedLibrary.Wrappers.Parsers.ReviewsWrapper.GetAppReviews </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_g_m_1_1_shared_library_1_1_wrappers_1_1_web_utils_1_1_web_request_wrapper.html">WebRequestWrapper</a>&#160;</td>
          <td class="paramname"><em>server</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_g_m_1_1_shared_library_1_1_parsers_1_1_parser.html">Parser</a>&#160;</td>
          <td class="paramname"><em>parser</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_g_m_1_1_shared_library_1_1_wrappers_1_1_mongo_d_b_1_1_mongo_d_b_wrapper.html">MongoDBWrapper</a>&#160;</td>
          <td class="paramname"><em>mongoDB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_g_m_1_1_shared_library_1_1_models_1_1_app_model.html">AppModel</a>&#160;</td>
          <td class="paramname"><em>parsedApp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>parseReviewsEnabled</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>parseUsersEnabled</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>maxUsersPerApp</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nUsers</em> = <code>-1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>allowAnyDate</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the app reviews as a List&lt;AppReview&gt;. CAUTION: If you are parsing more than one language, the program will use more RAM. </p>
<p>Because we need to parse a review in order to parse his users, if parseReviews is disabled but parseUsers is enabled, we'll only parse the reviews necesary to parse the users, and they will be erased afterward. </p>
<dl class="section return"><dt>Returns</dt><dd>All comments from all review pages, of yesterday, already parsed and ready to be inserted in DB.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">server</td><td>Server.</td></tr>
    <tr><td class="paramname">parser</td><td>Parser.</td></tr>
    <tr><td class="paramname">parsedApp</td><td>Parsed app.</td></tr>
    <tr><td class="paramname">parseReviewsEnabled</td><td>If set to <code>true</code> parse reviews enabled.</td></tr>
    <tr><td class="paramname">parseUsersEnabled</td><td>If set to <code>true</code> parse users enabled.</td></tr>
    <tr><td class="paramname">maxUsersPerApp</td><td>Max users to parse per app. 0 means no limit.</td></tr>
    <tr><td class="paramname">nUsers</td><td>Number of users already parsed. If only &ndash;users is enabled and we already reached the limit, don't allow the method to execute.</td></tr>
    <tr><td class="paramname">allowAnyDate</td><td>If set to <code>true</code> it will parse all reviews, from the beginning. If false, it will parse only yesterday reviews.</td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_reviews_wrapper_8cs_source.html#l00050">50</a> of file <a class="el" href="_reviews_wrapper_8cs_source.html">ReviewsWrapper.cs</a>.</p>
<div class="fragment"><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        {</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">            #region REGION:  INSTANCES, VARIABLES AND CONSTANTS</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> REVIEWS_MAX_PAGE = 110;                   <span class="comment">// If we reach this page, we&#39;ll stop to parse.</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">string</span> ANY_REVIEW_TOKEN = <span class="stringliteral">&quot;&lt;div class=&quot;</span>;      <span class="comment">// We use it to check if the request contains any review.</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;            <span class="keywordtype">string</span> prevResponse = <span class="keywordtype">string</span>.Empty;                             <span class="comment">// Response of the previous iteration.</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;            <span class="keywordtype">string</span> reviewsResponse;                                         <span class="comment">// HTML code of the processed reviews.</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;            <a class="code" href="class_g_m_1_1_shared_library_1_1_models_1_1_app_reviews_result.html">AppReviewsResult</a> parsedPageResult = <span class="keyword">new</span> <a class="code" href="class_g_m_1_1_shared_library_1_1_models_1_1_app_reviews_result.html">AppReviewsResult</a>();     <span class="comment">// The result of parse a single page of reviews.</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;            <a class="code" href="class_g_m_1_1_shared_library_1_1_models_1_1_app_reviews_result.html">AppReviewsResult</a> appReviewsResult = <span class="keyword">new</span> <a class="code" href="class_g_m_1_1_shared_library_1_1_models_1_1_app_reviews_result.html">AppReviewsResult</a>();     <span class="comment">// The final result of parse and filter all reviews pages for an app.</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;            <span class="keywordtype">string</span> language;                                    <span class="comment">// Current language of the reviews.</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;            <span class="keywordtype">int</span> nRetriesForReviews = 0;                         <span class="comment">// Counter of get reviews retries.</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;            <span class="keywordtype">int</span> nReviewPage = 0;                                <span class="comment">// Counter of parsed review pages.</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;            <span class="keywordtype">bool</span> anyReview;                                     <span class="comment">// When there&#39;s no more reviews for this app, it will be false.</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;            <span class="keywordtype">bool</span> isLastPage = <span class="keyword">false</span>;                            <span class="comment">// Flag to know if this is the last page.</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;            <span class="keywordtype">bool</span> isYesterdayReview = <span class="keyword">false</span>;                     <span class="comment">// Flag to know if the review&#39;s date it&#39;s yesterday.</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            <span class="keywordtype">bool</span> anyYesterdayReview;                            <span class="comment">// Flag to know if any review from the current page are from yesterday.</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;            List&lt;AppReview&gt; tmpReviews = <span class="keyword">new</span> List&lt;AppReview&gt;(); <span class="comment">// A list with all parsed reviews.</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;            List&lt;AppReview&gt; reviews = <span class="keyword">new</span> List&lt;AppReview&gt;();    <span class="comment">// The final list with yesterday&#39;s reviews.</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="preprocessor">            #endregion</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="preprocessor">            #region REGION:  PRECONDITIONS</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;            <span class="comment">// USERS LIMIT REACHED? -&gt; THEN LEAVE</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;            <span class="keywordflow">if</span>(nUsers &gt;= Constants.MAX_PARSED_USERS &amp;&amp; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                (!parseReviewsEnabled &amp;&amp; parseUsersEnabled))</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                <span class="keywordflow">return</span> appReviewsResult;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;            <span class="comment">// IF WE ARE NOT PARSING MORE USERS AND</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;            <span class="comment">// IS NOT IN VALID_REVIEWS_CATEGORIES? -&gt; THEN LEAVE</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;            <span class="keywordflow">if</span>(!mongoDB.<a class="code" href="class_g_m_1_1_shared_library_1_1_wrappers_1_1_mongo_d_b_1_1_mongo_d_b_wrapper.html#a99ff1ef57f1a2e084d9e276a3754d12a">IsValidCategory</a>(parsedApp.<a class="code" href="class_g_m_1_1_shared_library_1_1_models_1_1_app_model.html#a194ef66adb432f2cc90fa8a0a6bbaa6c">_id</a>,</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;                Constants.VALID_REVIEWS_CATEGORIES) &amp;&amp;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                (!parseUsersEnabled || nUsers &gt;= Constants.MAX_PARSED_USERS))</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                <span class="keywordflow">return</span> appReviewsResult;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="preprocessor">            #endregion</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;            <span class="comment">// For each language</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; Constants.REVIEWS_LANGUAGES.Length; i++) </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;            {</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                language = Constants.REVIEWS_LANGUAGES [i];</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                anyYesterdayReview = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                nReviewPage = 0;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                <span class="comment">// For each page</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                    nReviewPage++;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                    <span class="keywordflow">if</span> (nReviewPage &gt;= REVIEWS_MAX_PAGE) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="preprocessor">                    #region REGION:  REQUEST</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                    <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                        <a class="code" href="namespace_system.html">System</a>.Threading.Thread.Sleep(Constants.WAIT_FOR_REVIEWS);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                        reviewsResponse = this.<a class="code" href="class_g_m_1_1_shared_library_1_1_wrappers_1_1_parsers_1_1_reviews_wrapper.html#a1dbf6ef30abf44904c7e9a72d5045294">GetAppReviewsResponse</a> (parsedApp.<a class="code" href="class_g_m_1_1_shared_library_1_1_models_1_1_app_model.html#a194ef66adb432f2cc90fa8a0a6bbaa6c">_id</a>, nReviewPage, language, server);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                        <span class="comment">// IS THIS REQUEST EQUAL TO THE LAST ONE? -&gt; THEN THIS IS THE LAST PAGE</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                        <span class="keywordflow">if</span> (reviewsResponse == prevResponse){</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                            isLastPage = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                        }</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                        prevResponse = reviewsResponse;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                            </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                        <span class="comment">// TOO MANY CONSECUTIVE ERRORS? -&gt; LONG AND SEND AN EMAIL</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                        <span class="keywordflow">if</span> (reviewsResponse == String.Empty)</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                            nRetriesForReviews++;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                        <span class="keywordflow">if</span> (nRetriesForReviews &gt;= Constants.MAX_REQUEST_ERRORS) {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                            <a class="code" href="class_g_m_1_1_shared_library_1_1_wrappers_1_1_parsers_1_1_reviews_wrapper.html#ad57377c39e0155917bd8346f5f0d23d8">logger</a>.Warn (Constants.TOO_MANY_CONSECUTIVE_REQUESTS_ERROR);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                            ExceptionCallback.SendError (Constants.TOO_MANY_CONSECUTIVE_REQUESTS_ERROR, </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                                                         ref Globals.TOO_MANY_CONSECUTIVE_REQUESTS_ERROR_FLAG);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                        }</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                    } <span class="keywordflow">while</span>(nRetriesForReviews &gt;= Constants.RETRY_LIMIT);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                    <span class="keywordflow">if</span> (isLastPage) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="preprocessor">                    #endregion</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="preprocessor">                    #region REGION:  PARSE</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                    <span class="comment">// THERE IS ANY REVIEW?</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                    <span class="keywordflow">if</span> (reviewsResponse.IndexOf (ANY_REVIEW_TOKEN) == -1)</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                        anyReview = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                        anyReview = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                    <span class="comment">// IF SO, PARSE</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                    <span class="keywordflow">if</span> (reviewsResponse != null) </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                    {</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                        parsedPageResult = parser.<a class="code" href="class_g_m_1_1_shared_library_1_1_parsers_1_1_parser.html#abc18459e1fb02b36321a76e9c02751c6">ParseReviews</a>(parsedApp.<a class="code" href="class_g_m_1_1_shared_library_1_1_models_1_1_app_model.html#a194ef66adb432f2cc90fa8a0a6bbaa6c">_id</a>, reviewsResponse);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                        <span class="keywordflow">foreach</span> (<a class="code" href="class_g_m_1_1_shared_library_1_1_models_1_1_app_review.html">AppReview</a> review <span class="keywordflow">in</span> parsedPageResult.<a class="code" href="class_g_m_1_1_shared_library_1_1_models_1_1_app_reviews_result.html#a84bc5f9fef2f22b814e8ccbf76f514a4">appReviews</a>) </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                        {</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                            <span class="keywordflow">if</span> (Constants.REVIEW_DEBUG_A_ENABLED)</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                                <a class="code" href="class_g_m_1_1_shared_library_1_1_wrappers_1_1_parsers_1_1_reviews_wrapper.html#ad57377c39e0155917bd8346f5f0d23d8">logger</a>.Debug (<span class="stringliteral">&quot;PARSED COMMENT:\n&quot;</span> +</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                                review.<a class="code" href="class_g_m_1_1_shared_library_1_1_models_1_1_app_review.html#a8a6062f13c322428462ab3dde414e522">_id</a> + <span class="stringliteral">&quot;\n&quot;</span> +</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                                review.<a class="code" href="class_g_m_1_1_shared_library_1_1_models_1_1_app_review.html#a48150de188ee5594ba997b662c787055">appid</a> + <span class="stringliteral">&quot;\n&quot;</span> +</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                                review.<a class="code" href="class_g_m_1_1_shared_library_1_1_models_1_1_app_review.html#aaa52ea088903210c7abfec56bc9d7131">title</a> + <span class="stringliteral">&quot;\n&quot;</span> +</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                                review.<a class="code" href="class_g_m_1_1_shared_library_1_1_models_1_1_app_review.html#aeee5f5f7dd01c2a8752cb66544c27d62">body</a> + <span class="stringliteral">&quot;\n&quot;</span> +</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                                review.<a class="code" href="class_g_m_1_1_shared_library_1_1_models_1_1_app_review.html#a4b5b833b601cad3c51a898748b820350">date</a> + <span class="stringliteral">&quot;\n&quot;</span> +</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                                review.<a class="code" href="class_g_m_1_1_shared_library_1_1_models_1_1_app_review.html#ac74e149dd693b1c21d9e93f0e8d52d45">score</a>);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                            review.<a class="code" href="class_g_m_1_1_shared_library_1_1_models_1_1_app_review.html#af9516d5a0c447d0a19606adc439a88fb">lang</a> = language;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                            tmpReviews.Add (review);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                        }</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                    }</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="preprocessor">                    #endregion</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="preprocessor">                    #region REGION:  FILTER YESTERDAY REVIEWS</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                    <span class="comment">// Limit by date</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                    <span class="keywordflow">if</span> (!allowAnyDate)</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                    {</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                        <span class="keywordflow">foreach</span> (<a class="code" href="class_g_m_1_1_shared_library_1_1_models_1_1_app_review.html">AppReview</a> tmpReview <span class="keywordflow">in</span> tmpReviews) </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                        {</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                            isYesterdayReview = (tmpReview.<a class="code" href="class_g_m_1_1_shared_library_1_1_models_1_1_app_review.html#a4b5b833b601cad3c51a898748b820350">date</a> == <a class="code" href="namespace_g_m_1_1_shared_library_1_1_wrappers_1_1_mongo_d_b.html#ab857899e7cef215fd7d57f922999becba8cf10d2341ed01492506085688270c1e">DateTime</a>.Today.Date.AddDays (-1));</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                            <span class="keywordflow">if</span> (isYesterdayReview)</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                                appReviewsResult.<a class="code" href="class_g_m_1_1_shared_library_1_1_models_1_1_app_reviews_result.html#a84bc5f9fef2f22b814e8ccbf76f514a4">appReviews</a>.Add (tmpReview);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                                anyYesterdayReview = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                            <span class="keywordflow">if</span> (Constants.REVIEW_DEBUG_C_ENABLED) <a class="code" href="class_g_m_1_1_shared_library_1_1_wrappers_1_1_parsers_1_1_reviews_wrapper.html#ad57377c39e0155917bd8346f5f0d23d8">logger</a>.Debug(<span class="stringliteral">&quot;IS FROM YESTERDAY? -&gt; &quot;</span> + isYesterdayReview);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                        }</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                        <span class="keywordflow">if</span> (Constants.REVIEW_DEBUG_C_ENABLED) <a class="code" href="class_g_m_1_1_shared_library_1_1_wrappers_1_1_parsers_1_1_reviews_wrapper.html#ad57377c39e0155917bd8346f5f0d23d8">logger</a>.Debug(<span class="stringliteral">&quot;ANY FROM YESTERDAY? -&gt; &quot;</span> + anyYesterdayReview);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                        <span class="keywordflow">if</span> (anyYesterdayReview == <span class="keyword">false</span> || tmpReviews.Count == 0) <span class="keywordflow">break</span>; <span class="comment">// NOT ANY FROM YESTERDAY? -&gt; PARSE NEXT LANGUAGE</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                    }</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                    {</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                        appReviewsResult.<a class="code" href="class_g_m_1_1_shared_library_1_1_models_1_1_app_reviews_result.html#a84bc5f9fef2f22b814e8ccbf76f514a4">appReviews</a>.AddRange (tmpReviews);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                    }</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="preprocessor">                    #endregion</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="preprocessor">                    #region REGION:  LIMIT USERS PER APP</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                    <span class="comment">// Set max users parsed per app.</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                    <span class="keywordflow">if</span> (this.<a class="code" href="class_g_m_1_1_shared_library_1_1_wrappers_1_1_parsers_1_1_reviews_wrapper.html#ab5ffd98d568cafb0d8b18aafcd8d647b">parsedUsers</a> &lt; maxUsersPerApp || maxUsersPerApp == 0)</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                    {</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                        <span class="comment">// Limit exceeded? -&gt; truncate results.</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                        <span class="keywordflow">if</span> (parsedPageResult.<a class="code" href="class_g_m_1_1_shared_library_1_1_models_1_1_app_reviews_result.html#a47c987112afeb8af45ebeb828f52a881">authorUrls</a>.Count &gt; maxUsersPerApp &amp;&amp;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                            maxUsersPerApp != 0)</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                            parsedPageResult.<a class="code" href="class_g_m_1_1_shared_library_1_1_models_1_1_app_reviews_result.html#a47c987112afeb8af45ebeb828f52a881">authorUrls</a>.RemoveRange(0, parsedPageResult.<a class="code" href="class_g_m_1_1_shared_library_1_1_models_1_1_app_reviews_result.html#a47c987112afeb8af45ebeb828f52a881">authorUrls</a>.Count-maxUsersPerApp);</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                        <span class="comment">// Add users</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                        appReviewsResult.<a class="code" href="class_g_m_1_1_shared_library_1_1_models_1_1_app_reviews_result.html#a47c987112afeb8af45ebeb828f52a881">authorUrls</a>.AddRange(parsedPageResult.<a class="code" href="class_g_m_1_1_shared_library_1_1_models_1_1_app_reviews_result.html#a47c987112afeb8af45ebeb828f52a881">authorUrls</a>);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                        this.<a class="code" href="class_g_m_1_1_shared_library_1_1_wrappers_1_1_parsers_1_1_reviews_wrapper.html#af50cec793c3919393d0a917f6f3ebb00">ParsedUsers</a>+=parsedPageResult.<a class="code" href="class_g_m_1_1_shared_library_1_1_models_1_1_app_reviews_result.html#a47c987112afeb8af45ebeb828f52a881">authorUrls</a>.Count;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                    }</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                        </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                    <span class="keywordflow">if</span> (parseReviewsEnabled==<span class="keyword">false</span> &amp;&amp; parseUsersEnabled==<span class="keyword">true</span>)</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                    {</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                        <span class="comment">// Limit of users exceeded? -&gt; break</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                        i = Constants.REVIEWS_LANGUAGES.Length;         <span class="comment">// Leave language bucle</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                        <span class="keywordflow">if</span> (this.<a class="code" href="class_g_m_1_1_shared_library_1_1_wrappers_1_1_parsers_1_1_reviews_wrapper.html#ab5ffd98d568cafb0d8b18aafcd8d647b">parsedUsers</a> &gt;= maxUsersPerApp) <span class="keywordflow">break</span>;  <span class="comment">// Leave pages bucle</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                    }</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                    tmpReviews.Clear();</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="preprocessor">                    #endregion</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="preprocessor">                    #region REGION:  DEBUG IF ENABLED</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                    <span class="keywordflow">if</span> (Constants.REVIEW_DEBUG_B_ENABLED)</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                        <a class="code" href="class_g_m_1_1_shared_library_1_1_wrappers_1_1_parsers_1_1_reviews_wrapper.html#ad57377c39e0155917bd8346f5f0d23d8">logger</a>.Debug (reviewsResponse);</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                    </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                    <span class="keywordflow">if</span> (Constants.REVIEW_DEBUG_C_ENABLED)</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                        <a class="code" href="class_g_m_1_1_shared_library_1_1_wrappers_1_1_parsers_1_1_reviews_wrapper.html#ad57377c39e0155917bd8346f5f0d23d8">logger</a>.Debug (</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                        <span class="stringliteral">&quot;N REV ADDED: &quot;</span> + reviews.Count + <span class="stringliteral">&quot;\n&quot;</span> +</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                        <span class="stringliteral">&quot;LANG: &quot;</span> + language + <span class="stringliteral">&quot;\n&quot;</span> +</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                        <span class="stringliteral">&quot;PAGE: &quot;</span> + nReviewPage);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="preprocessor">                    #endregion</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                } <span class="keywordflow">while</span>(anyReview);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;            }</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="preprocessor">            #region REGION:  DEBUG IF ENABLED</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            <span class="keywordflow">if</span> (Constants.USERS_DEBUG_A_ENABLED)</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                <a class="code" href="class_g_m_1_1_shared_library_1_1_wrappers_1_1_parsers_1_1_reviews_wrapper.html#ad57377c39e0155917bd8346f5f0d23d8">logger</a>.Debug (<span class="stringliteral">&quot;YESTERDAY REVIES ADDED(before clear): &quot;</span> +</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                    appReviewsResult.<a class="code" href="class_g_m_1_1_shared_library_1_1_models_1_1_app_reviews_result.html#a84bc5f9fef2f22b814e8ccbf76f514a4">appReviews</a>.Count); <span class="comment">// DEBUG</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="preprocessor">            #endregion</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;            <span class="comment">// Only parseUsers enabled? -&gt; clear reviews</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;            <span class="keywordflow">if</span> (parseReviewsEnabled==<span class="keyword">false</span> &amp;&amp; parseUsersEnabled==<span class="keyword">true</span>)</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                appReviewsResult.<a class="code" href="class_g_m_1_1_shared_library_1_1_models_1_1_app_reviews_result.html#a84bc5f9fef2f22b814e8ccbf76f514a4">appReviews</a>.Clear();</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;            <span class="comment">// Reset counter.</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            this.<a class="code" href="class_g_m_1_1_shared_library_1_1_wrappers_1_1_parsers_1_1_reviews_wrapper.html#af50cec793c3919393d0a917f6f3ebb00">ParsedUsers</a> = 0;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="preprocessor">            #region REGION:  DEBUG IF ENABLED</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            <span class="keywordflow">if</span> (Constants.USERS_DEBUG_A_ENABLED &amp;&amp; </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                appReviewsResult.<a class="code" href="class_g_m_1_1_shared_library_1_1_models_1_1_app_reviews_result.html#a47c987112afeb8af45ebeb828f52a881">authorUrls</a>.Count &gt; 0) </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;            {</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                <a class="code" href="class_g_m_1_1_shared_library_1_1_wrappers_1_1_parsers_1_1_reviews_wrapper.html#ad57377c39e0155917bd8346f5f0d23d8">logger</a>.Debug (<span class="stringliteral">&quot;YESTERDAY REVIEWS (after clear)&quot;</span> +</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                    appReviewsResult.<a class="code" href="class_g_m_1_1_shared_library_1_1_models_1_1_app_reviews_result.html#a84bc5f9fef2f22b814e8ccbf76f514a4">appReviews</a>.Count);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                <a class="code" href="class_g_m_1_1_shared_library_1_1_wrappers_1_1_parsers_1_1_reviews_wrapper.html#ad57377c39e0155917bd8346f5f0d23d8">logger</a>.Debug (<span class="stringliteral">&quot;YESTERDAY REVIEWS (after clear)&quot;</span> +</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                    appReviewsResult.<a class="code" href="class_g_m_1_1_shared_library_1_1_models_1_1_app_reviews_result.html#a84bc5f9fef2f22b814e8ccbf76f514a4">appReviews</a>.Count);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                <a class="code" href="class_g_m_1_1_shared_library_1_1_wrappers_1_1_parsers_1_1_reviews_wrapper.html#ad57377c39e0155917bd8346f5f0d23d8">logger</a>.Debug (<span class="stringliteral">&quot;YESTERDAY USERS ADDED (after clear): &quot;</span> +</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                    appReviewsResult.<a class="code" href="class_g_m_1_1_shared_library_1_1_models_1_1_app_reviews_result.html#a47c987112afeb8af45ebeb828f52a881">authorUrls</a>.Count);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                Console.ReadLine ();</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;            }</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;            <a class="code" href="class_g_m_1_1_shared_library_1_1_wrappers_1_1_parsers_1_1_reviews_wrapper.html#ad57377c39e0155917bd8346f5f0d23d8">logger</a>.Debug (<span class="stringliteral">&quot;YESTERDAY REVIEWS ADDED: &quot;</span> + reviews.Count);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="preprocessor">            #endregion</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;            <span class="keywordflow">return</span> appReviewsResult;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        }</div>
<div class="ttc" id="class_g_m_1_1_shared_library_1_1_models_1_1_app_review_html_af9516d5a0c447d0a19606adc439a88fb"><div class="ttname"><a href="class_g_m_1_1_shared_library_1_1_models_1_1_app_review.html#af9516d5a0c447d0a19606adc439a88fb">GM.SharedLibrary.Models.AppReview.lang</a></div><div class="ttdeci">string lang</div><div class="ttdef"><b>Definition:</b> <a href="_app_review_8cs_source.html#l00019">AppReview.cs:19</a></div></div>
<div class="ttc" id="class_g_m_1_1_shared_library_1_1_models_1_1_app_review_html_ac74e149dd693b1c21d9e93f0e8d52d45"><div class="ttname"><a href="class_g_m_1_1_shared_library_1_1_models_1_1_app_review.html#ac74e149dd693b1c21d9e93f0e8d52d45">GM.SharedLibrary.Models.AppReview.score</a></div><div class="ttdeci">int score</div><div class="ttdef"><b>Definition:</b> <a href="_app_review_8cs_source.html#l00016">AppReview.cs:16</a></div></div>
<div class="ttc" id="class_g_m_1_1_shared_library_1_1_wrappers_1_1_parsers_1_1_reviews_wrapper_html_ab5ffd98d568cafb0d8b18aafcd8d647b"><div class="ttname"><a href="class_g_m_1_1_shared_library_1_1_wrappers_1_1_parsers_1_1_reviews_wrapper.html#ab5ffd98d568cafb0d8b18aafcd8d647b">GM.SharedLibrary.Wrappers.Parsers.ReviewsWrapper.parsedUsers</a></div><div class="ttdeci">int parsedUsers</div><div class="ttdef"><b>Definition:</b> <a href="_reviews_wrapper_8cs_source.html#l00019">ReviewsWrapper.cs:19</a></div></div>
<div class="ttc" id="class_g_m_1_1_shared_library_1_1_models_1_1_app_reviews_result_html_a47c987112afeb8af45ebeb828f52a881"><div class="ttname"><a href="class_g_m_1_1_shared_library_1_1_models_1_1_app_reviews_result.html#a47c987112afeb8af45ebeb828f52a881">GM.SharedLibrary.Models.AppReviewsResult.authorUrls</a></div><div class="ttdeci">List&lt; string &gt; authorUrls</div><div class="ttdef"><b>Definition:</b> <a href="_app_review_8cs_source.html#l00050">AppReview.cs:50</a></div></div>
<div class="ttc" id="namespace_system_html"><div class="ttname"><a href="namespace_system.html">System</a></div></div>
<div class="ttc" id="class_g_m_1_1_shared_library_1_1_wrappers_1_1_mongo_d_b_1_1_mongo_d_b_wrapper_html_a99ff1ef57f1a2e084d9e276a3754d12a"><div class="ttname"><a href="class_g_m_1_1_shared_library_1_1_wrappers_1_1_mongo_d_b_1_1_mongo_d_b_wrapper.html#a99ff1ef57f1a2e084d9e276a3754d12a">GM.SharedLibrary.Wrappers.MongoDB.MongoDBWrapper.IsValidCategory</a></div><div class="ttdeci">bool IsValidCategory(string _id, List&lt; string &gt; list)</div><div class="ttdoc">Checks in Constants.APPS_DATA_COLLECTION if the category of the app corresponds to any item in Consta...</div><div class="ttdef"><b>Definition:</b> <a href="_mongo_d_b_wrapper_8cs_source.html#l00958">MongoDBWrapper.cs:958</a></div></div>
<div class="ttc" id="class_g_m_1_1_shared_library_1_1_models_1_1_app_review_html_aeee5f5f7dd01c2a8752cb66544c27d62"><div class="ttname"><a href="class_g_m_1_1_shared_library_1_1_models_1_1_app_review.html#aeee5f5f7dd01c2a8752cb66544c27d62">GM.SharedLibrary.Models.AppReview.body</a></div><div class="ttdeci">string body</div><div class="ttdef"><b>Definition:</b> <a href="_app_review_8cs_source.html#l00018">AppReview.cs:18</a></div></div>
<div class="ttc" id="class_g_m_1_1_shared_library_1_1_parsers_1_1_parser_html_abc18459e1fb02b36321a76e9c02751c6"><div class="ttname"><a href="class_g_m_1_1_shared_library_1_1_parsers_1_1_parser.html#abc18459e1fb02b36321a76e9c02751c6">GM.SharedLibrary.Parsers.Parser.ParseReviews</a></div><div class="ttdeci">AppReviewsResult ParseReviews(string pageUrl, string response)</div><div class="ttdoc">Parse all all reviews from an app. </div><div class="ttdef"><b>Definition:</b> <a href="_parser_8cs_source.html#l01828">Parser.cs:1828</a></div></div>
<div class="ttc" id="class_g_m_1_1_shared_library_1_1_models_1_1_app_reviews_result_html_a84bc5f9fef2f22b814e8ccbf76f514a4"><div class="ttname"><a href="class_g_m_1_1_shared_library_1_1_models_1_1_app_reviews_result.html#a84bc5f9fef2f22b814e8ccbf76f514a4">GM.SharedLibrary.Models.AppReviewsResult.appReviews</a></div><div class="ttdeci">List&lt; AppReview &gt; appReviews</div><div class="ttdef"><b>Definition:</b> <a href="_app_review_8cs_source.html#l00049">AppReview.cs:49</a></div></div>
<div class="ttc" id="class_g_m_1_1_shared_library_1_1_models_1_1_app_review_html_a4b5b833b601cad3c51a898748b820350"><div class="ttname"><a href="class_g_m_1_1_shared_library_1_1_models_1_1_app_review.html#a4b5b833b601cad3c51a898748b820350">GM.SharedLibrary.Models.AppReview.date</a></div><div class="ttdeci">DateTime date</div><div class="ttdef"><b>Definition:</b> <a href="_app_review_8cs_source.html#l00014">AppReview.cs:14</a></div></div>
<div class="ttc" id="class_g_m_1_1_shared_library_1_1_wrappers_1_1_parsers_1_1_reviews_wrapper_html_af50cec793c3919393d0a917f6f3ebb00"><div class="ttname"><a href="class_g_m_1_1_shared_library_1_1_wrappers_1_1_parsers_1_1_reviews_wrapper.html#af50cec793c3919393d0a917f6f3ebb00">GM.SharedLibrary.Wrappers.Parsers.ReviewsWrapper.ParsedUsers</a></div><div class="ttdeci">int ParsedUsers</div><div class="ttdef"><b>Definition:</b> <a href="_reviews_wrapper_8cs_source.html#l00025">ReviewsWrapper.cs:25</a></div></div>
<div class="ttc" id="class_g_m_1_1_shared_library_1_1_models_1_1_app_model_html_a194ef66adb432f2cc90fa8a0a6bbaa6c"><div class="ttname"><a href="class_g_m_1_1_shared_library_1_1_models_1_1_app_model.html#a194ef66adb432f2cc90fa8a0a6bbaa6c">GM.SharedLibrary.Models.AppModel._id</a></div><div class="ttdeci">string _id</div><div class="ttdef"><b>Definition:</b> <a href="_app_model_8cs_source.html#l00012">AppModel.cs:12</a></div></div>
<div class="ttc" id="class_g_m_1_1_shared_library_1_1_models_1_1_app_reviews_result_html"><div class="ttname"><a href="class_g_m_1_1_shared_library_1_1_models_1_1_app_reviews_result.html">GM.SharedLibrary.Models.AppReviewsResult</a></div><div class="ttdoc">An object that contains separately appReviews their authors. authorUrls. Used for logic...</div><div class="ttdef"><b>Definition:</b> <a href="_app_review_8cs_source.html#l00047">AppReview.cs:47</a></div></div>
<div class="ttc" id="class_g_m_1_1_shared_library_1_1_wrappers_1_1_parsers_1_1_reviews_wrapper_html_ad57377c39e0155917bd8346f5f0d23d8"><div class="ttname"><a href="class_g_m_1_1_shared_library_1_1_wrappers_1_1_parsers_1_1_reviews_wrapper.html#ad57377c39e0155917bd8346f5f0d23d8">GM.SharedLibrary.Wrappers.Parsers.ReviewsWrapper.logger</a></div><div class="ttdeci">readonly Logger logger</div><div class="ttdef"><b>Definition:</b> <a href="_reviews_wrapper_8cs_source.html#l00018">ReviewsWrapper.cs:18</a></div></div>
<div class="ttc" id="class_g_m_1_1_shared_library_1_1_models_1_1_app_review_html_a8a6062f13c322428462ab3dde414e522"><div class="ttname"><a href="class_g_m_1_1_shared_library_1_1_models_1_1_app_review.html#a8a6062f13c322428462ab3dde414e522">GM.SharedLibrary.Models.AppReview._id</a></div><div class="ttdeci">string _id</div><div class="ttdef"><b>Definition:</b> <a href="_app_review_8cs_source.html#l00012">AppReview.cs:12</a></div></div>
<div class="ttc" id="class_g_m_1_1_shared_library_1_1_models_1_1_app_review_html"><div class="ttname"><a href="class_g_m_1_1_shared_library_1_1_models_1_1_app_review.html">GM.SharedLibrary.Models.AppReview</a></div><div class="ttdef"><b>Definition:</b> <a href="_app_review_8cs_source.html#l00009">AppReview.cs:9</a></div></div>
<div class="ttc" id="class_g_m_1_1_shared_library_1_1_wrappers_1_1_parsers_1_1_reviews_wrapper_html_a1dbf6ef30abf44904c7e9a72d5045294"><div class="ttname"><a href="class_g_m_1_1_shared_library_1_1_wrappers_1_1_parsers_1_1_reviews_wrapper.html#a1dbf6ef30abf44904c7e9a72d5045294">GM.SharedLibrary.Wrappers.Parsers.ReviewsWrapper.GetAppReviewsResponse</a></div><div class="ttdeci">string GetAppReviewsResponse(string appID, int reviewsPage, string language, WebRequestWrapper server)</div><div class="ttdoc">Gets the app reviews as a normalized string. </div><div class="ttdef"><b>Definition:</b> <a href="_reviews_wrapper_8cs_source.html#l00262">ReviewsWrapper.cs:262</a></div></div>
<div class="ttc" id="class_g_m_1_1_shared_library_1_1_models_1_1_app_review_html_a48150de188ee5594ba997b662c787055"><div class="ttname"><a href="class_g_m_1_1_shared_library_1_1_models_1_1_app_review.html#a48150de188ee5594ba997b662c787055">GM.SharedLibrary.Models.AppReview.appid</a></div><div class="ttdeci">string appid</div><div class="ttdef"><b>Definition:</b> <a href="_app_review_8cs_source.html#l00013">AppReview.cs:13</a></div></div>
<div class="ttc" id="namespace_g_m_1_1_shared_library_1_1_wrappers_1_1_mongo_d_b_html_ab857899e7cef215fd7d57f922999becba8cf10d2341ed01492506085688270c1e"><div class="ttname"><a href="namespace_g_m_1_1_shared_library_1_1_wrappers_1_1_mongo_d_b.html#ab857899e7cef215fd7d57f922999becba8cf10d2341ed01492506085688270c1e">GM.SharedLibrary.Wrappers.MongoDB.DateTime</a></div></div>
<div class="ttc" id="class_g_m_1_1_shared_library_1_1_models_1_1_app_review_html_aaa52ea088903210c7abfec56bc9d7131"><div class="ttname"><a href="class_g_m_1_1_shared_library_1_1_models_1_1_app_review.html#aaa52ea088903210c7abfec56bc9d7131">GM.SharedLibrary.Models.AppReview.title</a></div><div class="ttdeci">string title</div><div class="ttdef"><b>Definition:</b> <a href="_app_review_8cs_source.html#l00017">AppReview.cs:17</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1dbf6ef30abf44904c7e9a72d5045294"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">string GM.SharedLibrary.Wrappers.Parsers.ReviewsWrapper.GetAppReviewsResponse </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>appID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>reviewsPage</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>language</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_g_m_1_1_shared_library_1_1_wrappers_1_1_web_utils_1_1_web_request_wrapper.html">WebRequestWrapper</a>&#160;</td>
          <td class="paramname"><em>server</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets the app reviews as a normalized string. </p>
<dl class="section return"><dt>Returns</dt><dd>All reviews from one page, as a string, ready to be parsed.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">appID</td><td>App I.</td></tr>
    <tr><td class="paramname">reviewsPage</td><td>Reviews page.</td></tr>
    <tr><td class="paramname">server</td><td>Parse comments from this country.</td></tr>
    <tr><td class="paramname">server</td><td>Server.</td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_reviews_wrapper_8cs_source.html#l00262">262</a> of file <a class="el" href="_reviews_wrapper_8cs_source.html">ReviewsWrapper.cs</a>.</p>
<div class="fragment"><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        {</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;            <span class="keywordtype">string</span> postData = String.Format (Constants.REVIEWS_POST_DATA,</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                                             reviewsPage, appID, language);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="class_g_m_1_1_shared_library_1_1_wrappers_1_1_parsers_1_1_reviews_wrapper.html#a74654ff93385f598128c2d42742b32b2">NormalizeResponse</a>(server.<a class="code" href="class_g_m_1_1_shared_library_1_1_wrappers_1_1_web_utils_1_1_web_request_wrapper.html#af042a49450707cce18764eabb3b156ed">Post</a> (Constants.REVIEWS_URL, </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                                                  postData));</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        }</div>
<div class="ttc" id="class_g_m_1_1_shared_library_1_1_wrappers_1_1_parsers_1_1_reviews_wrapper_html_a74654ff93385f598128c2d42742b32b2"><div class="ttname"><a href="class_g_m_1_1_shared_library_1_1_wrappers_1_1_parsers_1_1_reviews_wrapper.html#a74654ff93385f598128c2d42742b32b2">GM.SharedLibrary.Wrappers.Parsers.ReviewsWrapper.NormalizeResponse</a></div><div class="ttdeci">string NormalizeResponse(string jsonResponse)</div><div class="ttdoc">Normalizes the response Replacing invalid characters with valid ones to ensure HTML correct formation...</div><div class="ttdef"><b>Definition:</b> <a href="_reviews_wrapper_8cs_source.html#l00281">ReviewsWrapper.cs:281</a></div></div>
<div class="ttc" id="class_g_m_1_1_shared_library_1_1_wrappers_1_1_web_utils_1_1_web_request_wrapper_html_af042a49450707cce18764eabb3b156ed"><div class="ttname"><a href="class_g_m_1_1_shared_library_1_1_wrappers_1_1_web_utils_1_1_web_request_wrapper.html#af042a49450707cce18764eabb3b156ed">GM.SharedLibrary.Wrappers.WebUtils.WebRequestWrapper.Post</a></div><div class="ttdeci">string Post(string url, string postData)</div><div class="ttdoc">Executes a POST creating an HttpWebRequest object based on previously set attributes. </div><div class="ttdef"><b>Definition:</b> <a href="_web_request_wrapper_8cs_source.html#l00338">WebRequestWrapper.cs:338</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_g_m_1_1_shared_library_1_1_wrappers_1_1_parsers_1_1_reviews_wrapper_a1dbf6ef30abf44904c7e9a72d5045294_cgraph.png" border="0" usemap="#class_g_m_1_1_shared_library_1_1_wrappers_1_1_parsers_1_1_reviews_wrapper_a1dbf6ef30abf44904c7e9a72d5045294_cgraph" alt=""/></div>
<map name="class_g_m_1_1_shared_library_1_1_wrappers_1_1_parsers_1_1_reviews_wrapper_a1dbf6ef30abf44904c7e9a72d5045294_cgraph" id="class_g_m_1_1_shared_library_1_1_wrappers_1_1_parsers_1_1_reviews_wrapper_a1dbf6ef30abf44904c7e9a72d5045294_cgraph">
<area shape="rect" id="node2" href="class_g_m_1_1_shared_library_1_1_wrappers_1_1_web_utils_1_1_web_request_wrapper.html#af042a49450707cce18764eabb3b156ed" title="Executes a POST creating an HttpWebRequest object based on previously set attributes. " alt="" coords="324,13,560,54"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a74654ff93385f598128c2d42742b32b2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">string GM.SharedLibrary.Wrappers.Parsers.ReviewsWrapper.NormalizeResponse </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>jsonResponse</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Normalizes the response Replacing invalid characters with valid ones to ensure HTML correct formation. </p>
<dl class="section return"><dt>Returns</dt><dd>The response. If response value is null, it means there's no comments. If response value is empty string, it means request error or url doesn't exists.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">jsonResponse</td><td>Json response.</td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_reviews_wrapper_8cs_source.html#l00281">281</a> of file <a class="el" href="_reviews_wrapper_8cs_source.html">ReviewsWrapper.cs</a>.</p>
<div class="fragment"><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        {</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            <span class="keywordtype">string</span> response;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;            <span class="keywordflow">if</span> (jsonResponse == String.Empty) <span class="keywordflow">return</span> String.Empty;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;            <span class="comment">// Translate Json to plain text.</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;            response = jsonResponse.Replace (<span class="stringliteral">&quot;\\u003c&quot;</span>, <span class="stringliteral">&quot;&lt;&quot;</span>)</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                .Replace (<span class="stringliteral">&quot;\\u003d&quot;</span>, <span class="stringliteral">&quot;=&quot;</span>).Replace (<span class="stringliteral">&quot;\\u003e&quot;</span>, <span class="stringliteral">&quot;&gt;&quot;</span>)</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                .Replace (<span class="stringliteral">&quot;\\u0026amp;&quot;</span>, <span class="stringliteral">&quot;&amp;&quot;</span>).Replace (<span class="stringliteral">@&quot;\&quot;&quot;&quot;</span>, <span class="stringliteral">@&quot;&quot;&quot;&quot;</span>);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;            <span class="keywordflow">try</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;            {</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                <span class="comment">// We remove the numPage tokens before to compare.</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                response = response</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                    .Substring (response</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                    .IndexOf (<span class="charliteral">&#39;,&#39;</span>, response.IndexOf (<span class="charliteral">&#39;,&#39;</span>) + 1));</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                response = response.Remove(response.LastIndexOf(<span class="charliteral">&#39;,&#39;</span>));</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                <span class="keywordflow">return</span> response;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;            }</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;            <span class="keywordflow">catch</span>(Exception e) </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;            {</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                <span class="comment">// TODO: elimina este bloque de debug</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                <a class="code" href="class_g_m_1_1_shared_library_1_1_wrappers_1_1_parsers_1_1_reviews_wrapper.html#ad57377c39e0155917bd8346f5f0d23d8">logger</a>.Error (response);    <span class="comment">// debug</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                <a class="code" href="class_g_m_1_1_shared_library_1_1_wrappers_1_1_parsers_1_1_reviews_wrapper.html#ad57377c39e0155917bd8346f5f0d23d8">logger</a>.Error (e.Message);   <span class="comment">// debug</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                Console.ReadLine ();        <span class="comment">// debug</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                <span class="comment">// Sometimes we can recieve an empty response.</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                <a class="code" href="namespace_system.html">System</a>.Threading.Thread.Sleep (1000);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;            }</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;            </div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        }</div>
<div class="ttc" id="namespace_system_html"><div class="ttname"><a href="namespace_system.html">System</a></div></div>
<div class="ttc" id="class_g_m_1_1_shared_library_1_1_wrappers_1_1_parsers_1_1_reviews_wrapper_html_ad57377c39e0155917bd8346f5f0d23d8"><div class="ttname"><a href="class_g_m_1_1_shared_library_1_1_wrappers_1_1_parsers_1_1_reviews_wrapper.html#ad57377c39e0155917bd8346f5f0d23d8">GM.SharedLibrary.Wrappers.Parsers.ReviewsWrapper.logger</a></div><div class="ttdeci">readonly Logger logger</div><div class="ttdef"><b>Definition:</b> <a href="_reviews_wrapper_8cs_source.html#l00018">ReviewsWrapper.cs:18</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="ad57377c39e0155917bd8346f5f0d23d8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">readonly Logger GM.SharedLibrary.Wrappers.Parsers.ReviewsWrapper.logger = LogManager.GetCurrentClassLogger ()</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_reviews_wrapper_8cs_source.html#l00018">18</a> of file <a class="el" href="_reviews_wrapper_8cs_source.html">ReviewsWrapper.cs</a>.</p>

</div>
</div>
<a class="anchor" id="ab5ffd98d568cafb0d8b18aafcd8d647b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int GM.SharedLibrary.Wrappers.Parsers.ReviewsWrapper.parsedUsers = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_reviews_wrapper_8cs_source.html#l00019">19</a> of file <a class="el" href="_reviews_wrapper_8cs_source.html">ReviewsWrapper.cs</a>.</p>

</div>
</div>
<h2 class="groupheader">Property Documentation</h2>
<a class="anchor" id="af50cec793c3919393d0a917f6f3ebb00"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int GM.SharedLibrary.Wrappers.Parsers.ReviewsWrapper.ParsedUsers</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">get</span><span class="mlabel">set</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_reviews_wrapper_8cs_source.html#l00025">25</a> of file <a class="el" href="_reviews_wrapper_8cs_source.html">ReviewsWrapper.cs</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>/home/zeioth/workspaces/csharp/GooglePlayTools/GooglePlayTools/SharedLibrary/Wrappers (Business rules)/<a class="el" href="_reviews_wrapper_8cs_source.html">ReviewsWrapper.cs</a></li>
</ul>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.8-->
<!-- start footer part -->
</div>
</div>
</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>
Generated on Thu Mar 10 2016 23:09:24 for Google Play Tools by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.9.1
</small></address>
</body>
</html>